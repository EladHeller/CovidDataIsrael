<html>

<head>
    <meta charset="utf-8">
    <style>
        table {
            border-collapse: collapse;
            border: 2px black solid;
            font: 12px sans-serif;
        }

        td {
            border: 1px black solid;
            padding: 5px;
        }
    </style>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123138137-9"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-123138137-9');
    </script>

    <script src="https://d3js.org/d3.v3.min.js"></script>
</head>

<body>

    <p>XLS with sheets <a href='out/covid.xlsx'>download</a></p>
    <p><a href="#" onclick='showtable("out/covid.csv")'>CSV containing all</a> <a href='out/covid.csv'>download</a></p>
    <div id="sheets"></div>
    <script>
        (async () => {
            const response = await fetch('dashreq.json');
            const json = await response.json();
            const names = json.requests.map(j => j.queryName);
            const html = names.map(name => `
          <p><a href="#" onclick='showtable("out/csv/${name}.csv")'>${name}</a> <a href='out/csv/${name}.csv'>download</a></p>
          `).join('');
            document.getElementById('sheets').innerHTML = html;
        })();
    </script>

    <div id="show"
        style="position: absolute;left: 400px;width: calc(100vw - 400px);height: 100vh;top: 0;z-index: -9999;"></div>
    <script type="text/javascript" charset="utf-8">
        function showtable(fileshow) {
            console.log(fileshow);
            d3.text(fileshow, function (data) {
                var parsedCSV = d3.csv.parseRows(data);

                var container = d3.select("#show")
                container.html('')

                container.append("table")

                    .selectAll("tr")
                    .data(parsedCSV).enter()
                    .append("tr")

                    .selectAll("td")
                    .data(function (d) { return d; }).enter()
                    .append("td")
                    .text(function (d) { return d; });
            });
        }
        showtable("out/csv/contagionDataPerCityPublic.csv");
    </script>
</body>

</html>